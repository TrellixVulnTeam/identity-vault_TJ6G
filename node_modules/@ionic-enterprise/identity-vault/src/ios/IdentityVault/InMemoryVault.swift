import Foundation

class InMemoryVault: VaultBase {
    override var vaultType: String? {
        return VaultType.IN_MEMORY.rawValue
    }

    override init(_ config: IdentityVaultConfig) throws {
        try super.init(config)
        self.data = [:]
    }

    override func clear() throws {
        self.data = nil
        self.data = [:]
        self.customPasscode = nil
    }

    override func doesVaultExist() throws -> Bool {
        return true
    }

    override func exportVault() throws -> [String: String]? {
        return self.data
    }

    override func lock() throws {
        try self.clear()
        return
    }

    override func importVault(_ data: [String: String]) throws {
        self.data = data
    }

    override func setValue(_ key: String, _ value: String?) throws {
        self.data![key] = value
    }

    override func removeValue(_ key: String) throws {
        self.data!.removeValue(forKey: key)
    }

    override func unlock(_ forceUnlock: Bool = true) throws {
        return
    }
}
